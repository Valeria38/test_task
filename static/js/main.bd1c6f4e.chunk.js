(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{11:function(e,t,a){e.exports=a(21)},17:function(e,t,a){},18:function(e,t,a){},21:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),o=a(9),s=a.n(o),r=(a(17),a(2)),i=a(10),l=a(1),u=a(3),d=a(4),p=a(6),m=a(5),f=a(7),h=(a(18),a(19)),g=function(e){function t(){var e,a;Object(u.a)(this,t);for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return(a=Object(p.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(c)))).state={active:[]},a.addClass=function(e,t){var n=a.props,c=n.showDetails,o=n.data,s=Array(o.length).fill(!1),r=s[e];s[e]=!r,a.setState({active:s},function(){c(t)})},a}return Object(f.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.title,n=t.data,o=this.state.active;return c.a.createElement("div",{className:"location"},c.a.createElement("p",{className:"location__title"},a),n.length?c.a.createElement("ul",{className:"location__items"},n.map(function(t,a){return c.a.createElement("li",{className:o[a]?"location__item active":"location__item",onClick:function(){e.addClass(a,t)},key:h()},t)})):"Countries"===a?c.a.createElement("div",{className:"location__loading"},"Loading..."):c.a.createElement("div",{className:"location__loading"}))}}]),t}(n.Component);var y=function(e){return fetch(e).then(function(e){return e.json()})},w="AIzaSyCjj3wuoUWKPBMR1HbUxyFn5lBnyjGOXKs",C="https://maps.googleapis.com/maps/api/geocode/json?address=",v=function(e,t){switch(t){case"cities":return Object.keys(e).sort(function(t,a){return e[a]-e[t]});case"countries":return Object.keys(e).sort(function(t,a){return e[a].length-e[t].length});case"companies":return e.sort(function(t,a){return e[t]-e[a]});default:e.sort(function(t,a){return e[t]-e[a]})}},b=function(e,t,a){var n,c,o;switch(e){case"USA":case"Canada":case"Ireland":n=parseInt(a)||"",c=a.replace(/^[ 0-9]+(-\s)?/g,"").replace(/\sSuite\s\d+(\w)?/,"").replace(/Way/,"St").replace(/Jefferson/,"SW Jefferson").replace(/Dr./,"Rd. NW").replace(/City Center Plaza 516 Main/,"516 E Main").split(" ").join("+"),o=t.replace(/\s/g,"+").replace(/Elgin/,"South Elgin");break;case"Germany":case"Brazil":case"Mexico":case"Spain":case"Argentina":case"Italy":case"Sweden":case"Austria":case"Switzerland":case"Portugal":case"Belgium":case"Denmark":case"Finland":case"Norway":case"Poland":n=a.replace(/[A-Za-z\.\s\xdf\xed\xf3\xe0\xea\xe7\xf1\xe4\xfa\xc5\xe6\/\,]+/,""),c=a.replace(/\s\s+/g," ").replace(/\//,"").replace(/\,?\s\d+$/,"").replace(/Platz/,"Str").replace(/Provinciale/,"Provinciale Sud").replace(/Bianco/,"Bianco Moncalieri").replace(/Grenzacherweg/,"").replace(/Estrada/,"Tv.").replace(/Rua do Mercado/,"Alameda do Mercado").split(" ").join("+"),o=t.replace(/\s/g,"+").replace(/M\xfcnster/,"Bocholt").replace(/\xc5/,"Aa");break;case"France":case"UK":n=parseInt(a)||"",c=a.replace(/\s\s+/g," ").replace(/^[ 0-9,]+(\s)?/g,"").replace(/-/,"+").split(" ").join("+"),o=t.replace(/\s/g,"+");break;case"Venezuela":n=parseInt(a)||a.match(/\d+/)[0]||"",c=a.replace(/\s\s+/g," ").replace(/\d+\xaa?\s/,"").replace(/\s#\d+-\d+/,"").replace(/Carrera con\s/,"").split(" ").join("+"),o=t.replace(/\s/g,"+");break;default:n=n=parseInt(a)||a.match(/\d+$/)[0]||"",c=a.replace(/\s\s+/g," ").split(" ").join("+"),o=t.replace(/\s/g,"+")}return{houseNumber:n,newStreet:c,newCity:o}},j=function(e){function t(){var e,a;Object(u.a)(this,t);for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return(a=Object(p.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(c)))).state={countries:[],cities:[],companies:[],collection:{},data:null,address:{},coords:{lat:0,lng:0}},a.setdefaultView=function(e){var t=a.state,n=t.collection,c=t.data,o=e[0],s=n[o].reduce(function(e,t){return e[t]=(e[t]||0)+1,e},{}),r=v(s,"cities")[0],i=c.find(function(e){return e.City===r}).Address,l=b(o,r,i),u=l.houseNumber,d=l.newStreet,p=l.newCity,m="".concat(C).concat(u,"+").concat(d,"+").concat(p,"+").concat(o,"&key=").concat(w);y(m).then(function(e){a.setState({coords:e.results[0].geometry.location},function(){a.initMap()})}).catch(function(e){return console.warn(e)})},a.addCitiesToCountries=function(){a.state.data.map(function(e){return a.setState({collection:Object(l.a)({},a.state.collection,Object(r.a)({},e.Country,[].concat(Object(i.a)(a.state.collection[e.Country]),[e.City])))},function(){console.log("Cities were added to country arrays")})})},a.sortCountries=function(){var e=a.state.collection,t=v(e,"countries");a.setState({countries:t},function(){console.log("Countries were sorted"),a.setdefaultView(t)})},a.showCountry=function(e){var t=a.state.collection[e].reduce(function(e,t){return e[t]=(e[t]||0)+1,e},{}),n=v(t,"cities");a.setState(function(t){return{cities:n,address:Object(l.a)({},t.address,{country:e})}})},a.showCity=function(e){var t=a.state.data.filter(function(t){return t.City===e}),n=[];t.forEach(function(e){return n.push(e.CompanyName)});var c=v(n,"companies");a.setState(function(t){return{companies:c,address:Object(l.a)({},t.address,{city:e})}})},a.showCompany=function(e){console.log(e);var t=a.state.data.filter(function(t){return t.CompanyName===e})[0].Address;a.setState(function(e){return{address:Object(l.a)({},e.address,{street:t})}},function(){a.getCoords(a.state.address)})},a.getCoords=function(e){var t=e.country,n=e.city,c=e.street;console.log(t,n,c),c.includes("'")&&(c=c.replace(/\'/,""));var o=b(t,n,c),s=o.houseNumber,r=o.newStreet,i=o.newCity,l="".concat(C).concat(s,"+").concat(r,"+").concat(i,"+").concat(t,"&key=").concat(w);y(l).then(function(e){a.setState({coords:e.results[0].geometry.location},function(){a.initMap()})}).catch(function(e){return console.warn(e)})},a.renderMap=function(){!function(e){var t=window.document.getElementsByTagName("script")[0],a=window.document.createElement("script");a.src=e,a.async=!0,a.defer=!0,t.parentNode.insertBefore(a,t)}("https://maps.googleapis.com/maps/api/js?key=".concat(w,"&callback=initMap")),window.initMap=a.initMap},a.initMap=function(){var e=a.state.coords,t=e.lat,n=e.lng,c=new window.google.maps.Map(document.getElementById("map"),{center:{lat:t,lng:n},zoom:15});new window.google.maps.Marker({position:{lat:t,lng:n},map:c})},a.changePosition=function(e){var t=e.lat,n=e.lng;a.setState({coords:{lat:t,lng:n}},function(){a.initMap()})},a}return Object(f.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.renderMap(),y("https://api.myjson.com/bins/kmvt0").then(function(t){t.Customers.map(function(a){return e.setState({collection:Object(l.a)({},e.state.collection,Object(r.a)({},a.Country,[])),data:t.Customers},function(){console.log("Countries were successfully added to this.state.collection")})}),e.addCitiesToCountries(),e.sortCountries()}).catch(function(e){return console.warn(e)})}},{key:"render",value:function(){return c.a.createElement("div",{className:"App"},c.a.createElement(g,{title:"Countries",data:this.state.countries,showDetails:this.showCountry}),c.a.createElement(g,{title:"Cities",data:this.state.cities,showDetails:this.showCity}),c.a.createElement(g,{title:"Company",data:this.state.companies,showDetails:this.showCompany}),c.a.createElement("div",{className:"map"},c.a.createElement("p",{className:"map__title"},"Map"),c.a.createElement("div",{className:"map__display"},c.a.createElement("div",{id:"map"}))))}}]),t}(n.Component);s.a.render(c.a.createElement(j,null),document.getElementById("root"))}},[[11,1,2]]]);
//# sourceMappingURL=main.bd1c6f4e.chunk.js.map